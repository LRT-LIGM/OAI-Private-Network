# FlexRIC and xApp Integration with OAI 5G

## Objective

This document explains how to launch FlexRIC and integrate a custom xApp to monitor and control a 5G Standalone (SA) deployment using the OpenAirInterface (OAI) stack. It is intended for lab teams continuing this project after the internship.

---

## 1. Prerequisites

- Operational OAI 5G Core and gNodeB (can be in simulation mode with `--rfsim`)
- Docker and Docker Compose installed
- Python 3 and `xapp_sdk` Python binding
- FlexRIC compiled and installed correctly

---

## 2. Step-by-step Setup

### 2.1 Launching the OAI 5G Core

From the OAI 5GC folder:

```bash
cd ~/OAI-5GCN-v2.0.1/docker-compose
python3 core-network.py --type start-basic --scenario 1
```

Verify that all containers (AMF, SMF, UPF, NRF, etc.) are in a healthy state.

---

### 2.2 Launching the gNodeB

From the OAI RAN build directory:

```bash
cd ~/openairinterface5g/cmake_targets/ran_build/build/
sudo ./nr-softmodem -O config/5GN78.conf --sa -E --continuous-tx
```

Make sure the gNodeB connects properly and is visible to the AMF.

>lanch quectel CM if wanted !

```bash
cd ~/Documents/quectel/quectel-CM/out
sudo ./quectel-CM -s oai
```

> If you don't have the IP address, access this page for troubleshooting!  
See: [Troubleshooting Modem Connection](../troubleshooting/modem_connection.md)

---

### 2.3 Starting the Near-RT RIC

From FlexRIC’s build directory:

```bash
cd ~/
./flexric/build/examples/ric/nearRT-RIC
```

This launches the Near-Real-Time RIC, loads all available Service Models (SMs), and waits for E2 connections from gNodeB.

---

### 2.4 Launching the xApp (C version)

For testing purposes, you can use the C-based xApp:

```bash
cd ~/flexric
./build/examples/xApp/c/monitor/xapp_gtp_mac_rlc_pdcp_moni -p /usr/local/lib/flexric/ -c /usr/local/etc/flexric/flexric.conf
```

It subscribes to GTP, MAC, RLC, and PDCP metrics and displays latency statistics.

---

### 2.5 Using the Python xApps (Optional)

Alternative monitoring and control can be done using the Python xApps (see next document for details).

```bash
cd ~/flexric/examples/xApp/python3
python3 xapp_slice_moni_ctrl.py
```

---

### 2.6 Output

A temporary database file is saved in:

```
/tmp/xapp_db_TIMESTAMP
```

```bash
cd /tmp/
ls -la
```

Use SQLite or export scripts to extract and analyze collected metrics.

---

## 3. Important Notes

- All interactions are done via the E2 interface (E2AP).
- Metrics are collected in near real-time for each UE.
- Slicing can be dynamically modified using Python xApps.
- Make sure the FlexRIC configuration file (`flexric.conf`) is correct.

---

## 4. References

- OAI 5G Documentation: https://gitlab.eurecom.fr/oai
- FlexRIC GitHub: https://github.com/flexric/flexric
- 3GPP TS 38.401 – NG-RAN; Architecture Description

